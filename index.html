<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 1.2.2">
<meta name="crystal_docs.project_version" content="6.0.0">
<meta name="crystal_docs.project_name" content="rethinkdb-orm">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="rethinkdb-orm">
  <title>rethinkdb-orm 6.0.0</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          rethinkdb-orm
        </a>
      </h1>

      <span class="project-version">
        6.0.0
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent " data-id="rethinkdb-orm/RethinkDB" data-name="rethinkdb">
      <a href="RethinkDB.html">RethinkDB</a>
      
        <ul>
  
  <li class=" " data-id="rethinkdb-orm/RethinkDB/Connection" data-name="rethinkdb::connection">
      <a href="RethinkDB/Connection.html">Connection</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="rethinkdb-orm/RethinkORM" data-name="rethinkorm">
      <a href="RethinkORM.html">RethinkORM</a>
      
        <ul>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/AssociationCollection" data-name="rethinkorm::associationcollection(owner, target)">
      <a href="RethinkORM/AssociationCollection.html">AssociationCollection</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Associations" data-name="rethinkorm::associations">
      <a href="RethinkORM/Associations.html">Associations</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Base" data-name="rethinkorm::base">
      <a href="RethinkORM/Base.html">Base</a>
      
    </li>
  
  <li class="parent " data-id="rethinkdb-orm/RethinkORM/Changefeed" data-name="rethinkorm::changefeed(t)">
      <a href="RethinkORM/Changefeed.html">Changefeed</a>
      
        <ul>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Changefeed/Change" data-name="rethinkorm::changefeed::change(t)">
      <a href="RethinkORM/Changefeed/Change.html">Change</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Changefeed/Event" data-name="rethinkorm::changefeed::event">
      <a href="RethinkORM/Changefeed/Event.html">Event</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Changefeed/Raw" data-name="rethinkorm::changefeed::raw">
      <a href="RethinkORM/Changefeed/Raw.html">Raw</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Collection" data-name="rethinkorm::collection(t)">
      <a href="RethinkORM/Collection.html">Collection</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Connection" data-name="rethinkorm::connection">
      <a href="RethinkORM/Connection.html">Connection</a>
      
    </li>
  
  <li class="parent " data-id="rethinkdb-orm/RethinkORM/Error" data-name="rethinkorm::error">
      <a href="RethinkORM/Error.html">Error</a>
      
        <ul>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Error/ChangefeedClosed" data-name="rethinkorm::error::changefeedclosed">
      <a href="RethinkORM/Error/ChangefeedClosed.html">ChangefeedClosed</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Error/ConnectError" data-name="rethinkorm::error::connecterror">
      <a href="RethinkORM/Error/ConnectError.html">ConnectError</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Error/DatabaseError" data-name="rethinkorm::error::databaseerror">
      <a href="RethinkORM/Error/DatabaseError.html">DatabaseError</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Error/DocumentExists" data-name="rethinkorm::error::documentexists">
      <a href="RethinkORM/Error/DocumentExists.html">DocumentExists</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Error/DocumentInvalid" data-name="rethinkorm::error::documentinvalid">
      <a href="RethinkORM/Error/DocumentInvalid.html">DocumentInvalid</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Error/DocumentNotFound" data-name="rethinkorm::error::documentnotfound">
      <a href="RethinkORM/Error/DocumentNotFound.html">DocumentNotFound</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Error/DocumentNotSaved" data-name="rethinkorm::error::documentnotsaved">
      <a href="RethinkORM/Error/DocumentNotSaved.html">DocumentNotSaved</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Error/LockInvalidOp" data-name="rethinkorm::error::lockinvalidop">
      <a href="RethinkORM/Error/LockInvalidOp.html">LockInvalidOp</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Error/LockLost" data-name="rethinkorm::error::locklost">
      <a href="RethinkORM/Error/LockLost.html">LockLost</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Error/LockUnavailable" data-name="rethinkorm::error::lockunavailable">
      <a href="RethinkORM/Error/LockUnavailable.html">LockUnavailable</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/IdGenerator" data-name="rethinkorm::idgenerator">
      <a href="RethinkORM/IdGenerator.html">IdGenerator</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Index" data-name="rethinkorm::index">
      <a href="RethinkORM/Index.html">Index</a>
      
    </li>
  
  <li class="parent " data-id="rethinkdb-orm/RethinkORM/Lock" data-name="rethinkorm::lock">
      <a href="RethinkORM/Lock.html">Lock</a>
      
        <ul>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Lock/FloatEpochConverter" data-name="rethinkorm::lock::floatepochconverter">
      <a href="RethinkORM/Lock/FloatEpochConverter.html">FloatEpochConverter</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Lock/Reentrant" data-name="rethinkorm::lock::reentrant">
      <a href="RethinkORM/Lock/Reentrant.html">Reentrant</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Lock/TokenRefresher" data-name="rethinkorm::lock::tokenrefresher">
      <a href="RethinkORM/Lock/TokenRefresher.html">TokenRefresher</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Persistence" data-name="rethinkorm::persistence">
      <a href="RethinkORM/Persistence.html">Persistence</a>
      
    </li>
  
  <li class="parent " data-id="rethinkdb-orm/RethinkORM/Queries" data-name="rethinkorm::queries">
      <a href="RethinkORM/Queries.html">Queries</a>
      
        <ul>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Queries/HasChanges" data-name="rethinkorm::queries::haschanges">
      <a href="RethinkORM/Queries/HasChanges.html">HasChanges</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Queries/R" data-name="rethinkorm::queries::r">
      <a href="RethinkORM/Queries/R.html">R</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="rethinkdb-orm/RethinkORM/Settings" data-name="rethinkorm::settings">
      <a href="RethinkORM/Settings.html">Settings</a>
      
        <ul>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Settings/HabitatSettings" data-name="rethinkorm::settings::habitatsettings">
      <a href="RethinkORM/Settings/HabitatSettings.html">HabitatSettings</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Table" data-name="rethinkorm::table">
      <a href="RethinkORM/Table.html">Table</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Timestamps" data-name="rethinkorm::timestamps">
      <a href="RethinkORM/Timestamps.html">Timestamps</a>
      
    </li>
  
  <li class=" " data-id="rethinkdb-orm/RethinkORM/Validators" data-name="rethinkorm::validators">
      <a href="RethinkORM/Validators.html">Validators</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1><a id="rethink-db-orm-for-crystal-lang" class="anchor" href="#rethink-db-orm-for-crystal-lang">  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>RethinkDB ORM for Crystal Lang</h1>
<p><a href="https://github.com/spider-gazelle/rethinkdb-orm/actions/workflows/ci.yml"><img src="https://github.com/spider-gazelle/rethinkdb-orm/actions/workflows/ci.yml/badge.svg" alt="CI" /></a>
<a href="https://spider-gazelle.github.io/rethinkdb-orm"><img src="https://img.shields.io/badge/Documentation-available-brightgreen.svg" alt="Documentation" /></a></p>
<p>Extending <a href="https://github.com/spider-gazelle/active-model">ActiveModel</a> for attribute definitions, callbacks and validations</p>
<ul>
<li><a href="#rethinkdb-orm-for-crystal-lang">RethinkDB ORM for Crystal Lang</a>
<ul>
<li><a href="#callbacks">Callbacks</a></li>
<li><a href="#associations">Associations</a>
<ul>
<li><a href="#belongsto"><code>belongs_to</code></a></li>
<li><a href="#hasmany"><code>has_many</code></a></li>
<li><a href="#hasone"><code>has_one</code></a></li>
<li><a href="#dependency">Dependency</a></li>
</ul>
</li>
<li><a href="#indexes">Indexes</a></li>
<li><a href="#changefeeds">Changefeeds</a></li>
<li><a href="#validations">Validations</a>
<ul>
<li><a href="#ensureunique"><code>ensure_unique</code></a></li>
</ul>
</li>
<li><a href="#timestamps">Timestamps</a></li>
</ul>
</li>
</ul>
<h2><a id="configuration" class="anchor" href="#configuration">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Configuration</h2>
<pre><code class="language-crystal"><span class="c"># Below is the list of settings exposed by RethinkORM and their defaults</span>
<span class="t">RethinkORM</span><span class="t">::</span><span class="t">Settings</span>.configure <span class="k">do</span> <span class="o">|</span>settings<span class="o">|</span>
  settings.host <span class="o">=</span> <span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_HOST&quot;</span>]? || <span class="s">&quot;localhost&quot;</span>
  settings.port <span class="o">=</span> (<span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_PORT&quot;</span>]? || <span class="n">28015</span>).to_i
  settings.db <span class="o">=</span> <span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_DB&quot;</span>]? || <span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_DATABASE&quot;</span>]? || <span class="s">&quot;test&quot;</span>
  settings.user <span class="o">=</span> <span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_USER&quot;</span>]? || <span class="s">&quot;admin&quot;</span>
  settings.password <span class="o">=</span> <span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_PASSWORD&quot;</span>]? || <span class="s">&quot;&quot;</span>
  settings.lock_expire <span class="o">=</span> (<span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_LOCK_EXPIRE&quot;</span>]? || <span class="n">30</span>).to_i.seconds
  settings.lock_timeout <span class="o">=</span> (<span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_LOCK_TIMEOUT&quot;</span>]? || <span class="n">5</span>).to_i.seconds
  settings.retry_interval <span class="o">=</span> (<span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_TIMEOUT&quot;</span>]? || <span class="n">2</span>).to_i.seconds

  <span class="c"># Driver level reconnection attempts</span>
  settings.retry_attempts <span class="o">=</span> <span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_RETRIES&quot;</span>]?.try(<span class="o">&amp;</span>.to_i) || <span class="n">10</span>

  <span class="c"># ORM level query retries</span>
  settings.query_retries <span class="o">=</span> <span class="t">ENV</span>[<span class="s">&quot;RETHINKDB_QUERY_RETRIES&quot;</span>]?.try <span class="o">&amp;</span>.to_i || <span class="n">10</span>
<span class="k">end</span></code></pre>
<h2><a id="callbacks" class="anchor" href="#callbacks">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Callbacks</h2>
<p>Register callbacks for <code>save</code>, <code>update</code>, <code>create</code> and <code>destroy</code> by setting the corresponding before/after callback handler.</p>
<pre><code class="language-crystal"><span class="k">class</span> <span class="t">ModelWithCallbacks</span> <span class="o">&lt;</span> <span class="t">RethinkORM</span><span class="t">::</span><span class="t">Base</span>
  attribute address : <span class="t">String</span>
  attribute age : <span class="t">Int32</span> <span class="o">=</span> <span class="n">10</span>

  before_create <span class="n">:set_address</span>
  after_update <span class="n">:set_age</span>
  before_destroy <span class="k">do</span>
    <span class="k">self</span>.name <span class="o">=</span> <span class="s">&quot;joe&quot;</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="m">set_address</span>
    <span class="k">self</span>.address <span class="o">=</span> <span class="s">&quot;23&quot;</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="m">set_age</span>
    <span class="k">self</span>.age <span class="o">=</span> <span class="n">30</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
<h2><a id="associations" class="anchor" href="#associations">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Associations</h2>
<p>Set associations with <code>belongs_to</code>, <code>has_many</code> and <code>has_one</code>.</p>
<p>Access children in parent by accessing the method correpsonding to the pluralised child. Children collection method name is generated by dumb pluralisation (appending an s). Optionally set children collection name in <code>has_many</code> by setting <code>collection_name</code> param.</p>
<p>The <code>has_many</code> association requires the <code>belongs_to</code> association on the child. By default, <code>belongs_to</code> creates a secondary index on the foreign key.</p>
<pre><code class="language-crystal"><span class="k">class</span> <span class="t">Parent</span> <span class="o">&lt;</span> <span class="t">RethinkORM</span><span class="t">::</span><span class="t">Base</span>
  attribute name : <span class="t">String</span>
  has_many <span class="t">Child</span>, collection_name: <span class="s">&quot;children&quot;</span>
<span class="k">end</span>

<span class="k">class</span> <span class="t">Child</span> <span class="o">&lt;</span> <span class="t">RethinkORM</span><span class="t">::</span><span class="t">Base</span>
  attribute age : <span class="t">Int32</span>
  belongs_to <span class="t">Parent</span>
  has_many <span class="t">Pet</span>
<span class="k">end</span>

<span class="k">class</span> <span class="t">Pet</span> <span class="o">&lt;</span> <span class="t">RethinkORM</span><span class="t">::</span><span class="t">Base</span>
  attribute name : <span class="t">String</span>
  belongs_to <span class="t">Child</span>
<span class="k">end</span>

parent <span class="o">=</span> <span class="t">Parent</span>.<span class="k">new</span>(name: <span class="s">&quot;Phil&quot;</span>)
parent.children.empty? <span class="c"># =&gt; true</span>

child <span class="o">=</span> <span class="t">Child</span>.<span class="k">new</span>(age: <span class="n">99</span>)
child.pets.empty? <span class="c"># =&gt; true</span></code></pre>
<h3><a id="belongs-to" class="anchor" href="#belongs-to">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>belongs_to</code></h3>
<p>Parameter      |                                                               | Default
-------------- | ------------------------------------------------------------- | -------
<code>parent_class</code> | The parent class who this class is dependent on               |
<code>dependent</code>    | Sets destroy behaviour. One of <code>:none</code>, <code>:destroy</code>, <code>:delete</code> | <code>:none</code>
<code>create_index</code> | Create a secondary index on the foreign key                   | <code>true</code></p>
<h3><a id="has-many" class="anchor" href="#has-many">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>has_many</code></h3>
<p>Parameter         |                                                                               | Default
----------------- | ----------------------------------------------------------------------------- | -------
<code>child_class</code>     | The parent class who this class is dependent on                               |
<code>dependent</code>       | Sets destroy behaviour. One of <code>:none</code>, <code>:destroy</code>, <code>:delete</code>                 | <code>:none</code>
<code>collection_name</code> | Define collection name, otherwise collection named through dumb pluralisation | <code>nil</code></p>
<h3><a id="has-one" class="anchor" href="#has-one">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>has_one</code></h3>
<p>Parameter         |                                                                               | Default
----------------- | ----------------------------------------------------------------------------- | -------
<code>child_class</code>     | The parent class who this class is dependent on                               |
<code>dependent</code>       | Sets destroy behaviour. One of <code>:none</code>, <code>:destroy</code>, <code>:delete</code>                 | <code>:none</code>
<code>collection_name</code> | Define collection name, otherwise collection named through dumb pluralisation | <code>nil</code></p>
<h3><a id="dependency" class="anchor" href="#dependency">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Dependency</h3>
<p><code>dependent</code> param in the association definition macros defines the fate of the association on model destruction.<br>
Default is <code>:none</code>, <code>:destroy</code> and <code>:delete</code> ensure destruction of association dependents.</p>
<h2><a id="indexes" class="anchor" href="#indexes">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Indexes</h2>
<p>Set secondary indexes with <code>secondary_index</code></p>
<p>Parameter   |                                               |
----------- | --------------------------------------------- |
<code>attribute</code> | defines the field on which to create an index |</p>
<h2><a id="changefeeds" class="anchor" href="#changefeeds">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Changefeeds</h2>
<p>Access the changefeed of a document or table through the <code>changes</code> query.<br>
Defaults to watch for events on a table if no id provided.</p>
<p>Parameter |                                     | Default
--------- | ----------------------------------- | -------
<code>id</code>      | id of document to watch for changes | nil</p>
<p>Returns an iterator that emits <code>NamedTuple(value: T, event: Event)</code><br></p>
<ul>
<li><code>Changefeed::Event::Deleted</code> events yield the deleted model</li>
<li><code>Changefeed::Event::Created</code> events yield the created model</li>
<li><code>Changefeed::Event::Updated</code> events yield the updated model</li>
</ul>
<pre><code class="language-crystal"><span class="k">class</span> <span class="t">Game</span> <span class="o">&lt;</span> <span class="t">RethinkORM</span><span class="t">::</span><span class="t">Base</span>
  attribute <span class="k">type</span> : <span class="t">String</span>
  attribute score : <span class="t">Int32</span>, default: <span class="n">0</span>
<span class="k">end</span>

ballgame <span class="o">=</span> <span class="t">Game</span>.create!(<span class="k">type</span>: <span class="s">&quot;footy&quot;</span>)

<span class="c"># Observe changes on a single document</span>
spawn <span class="k">do</span>
  <span class="t">Game</span>.changes(ballgame.id).each <span class="k">do</span> <span class="o">|</span>change<span class="o">|</span>
    game <span class="o">=</span> change.value
    puts <span class="s">&quot;looks like the score is </span><span class="i">#{</span>game.score<span class="i">}</span><span class="s">&quot;</span> <span class="k">unless</span> game.<span class="k">nil?</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c"># Observe changes on a table</span>
spawn <span class="k">do</span>
  <span class="t">Game</span>.changes.each <span class="k">do</span> <span class="o">|</span>change<span class="o">|</span>
    game <span class="o">=</span> change.value
    puts <span class="s">&quot;</span><span class="i">#{</span>game.<span class="k">type</span><span class="i">}</span><span class="s">: </span><span class="i">#{</span>game.score<span class="i">}</span><span class="s">&quot;</span> <span class="k">unless</span> game.<span class="k">nil?</span>
    puts <span class="s">&quot;game event: </span><span class="i">#{</span>change.event<span class="i">}</span><span class="s">&quot;</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
<h2><a id="validations" class="anchor" href="#validations">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Validations</h2>
<p>Builds on <a href="https://github.com/spider-gazelle/active-model#validations">active-model's validation</a></p>
<h3><a id="ensure-unique" class="anchor" href="#ensure-unique">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a><code>ensure_unique</code></h3>
<p>Fails to validate if field with duplicate value present in db.
If scope is set, the callback/block signature must be a tuple with types matching that of the scope.
The field(s) are set with the result of the transform block upon successful validation</p>
<p>Parameter               |                                                         | Default
----------------------- | ------------------------------------------------------- | -------
<code>field</code>                 | Model attribute on which to guarantee uniqueness        |
<code>scope</code>                 | Attributes passed to the transform, defaults to :field  | nil
<code>create_index</code>          | Whether or not to generate a secondary index            | true
<code>callback : T -&gt; T</code>     | Optional function to transform field value              | nil
<code>block : T -&gt; T</code>        | Optional block to transform field value before querying | nil</p>
<h2><a id="timestamps" class="anchor" href="#timestamps">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Timestamps</h2>
<p>Adds creates <code>created_at</code> and <code>updated_at</code> attributes.</p>
<ul>
<li><code>updated_at</code> is set through the <code>before_update</code> callback, and initially set in the <code>before_save</code> callback.</li>
<li><code>created_at</code> is set through the <code>before_create</code> callback.</li>
</ul>
<p>The generated timestamp is UTC.</p>
<pre><code class="language-crystal"><span class="k">class</span> <span class="t">Timo</span> <span class="o">&lt;</span> <span class="t">RethinkORM</span><span class="t">::</span><span class="t">Base</span>
  <span class="c"># Simply include the module</span>
  <span class="k">include</span> <span class="t">RethinkORM</span><span class="t">::</span><span class="t">Timestamps</span>

  attribute name : <span class="t">String</span>
<span class="k">end</span></code></pre>
</div>
</body>
</html>
